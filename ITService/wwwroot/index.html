<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ITService</title>
    <base href="/" />
    <!--<link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />-->
    <link href="css/app.css" rel="stylesheet" />

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap-theme.min.css" integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">
    <link href="css/Customs/fieldset.css" rel="stylesheet" />
    <link href="css/Customs/designdetail.css" rel="stylesheet" />
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
</head>


<body>
    <app>Loading...</app>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">🗙</a>
    </div>
    <script src="_framework/blazor.webassEMbly.js"></script>



    <!--Data Account-->
    <script>
        function TestDataTablesAdd(table, Url) {

            $(document).ready(function () {
                $(table).DataTable({
                    "bAutoWidth": false,
                    "ajax": {
                        "url": Url,
                        "type": "GET",
                        "dataSrc": ""
                    },
                    "columns": [
                        { 'data': "emP_ID", sClass: "text-center" },
                        { 'data': "emP_NAMETH", sClass: "text-center" },
                        { 'data': "emP_LASTNAMETH", sClass: "text-center" },
                        { 'data': "emP_MAIL", sClass: "text-center" },
                        { 'data': "emP_DEPT", sClass: "text-center" },
                        {
                            'data': 'activate',
                            'orderable': false,
                            "className": "text-center",
                            'render': function (ID, type, data, obj) {
                                if (data.activate != "1") {
                                    return '<input id="toggle-demo" class="my_switch" type="checkbox" data-toggle="toggle" data-on="เปิดใช้งาน" data-off="ปิดใช้งาน" data-onstyle="success" data-offstyle="danger" onchange="ActivateStatus(' + data.emP_ID + ',' + data.activate + ');" >';

                                }
                                else {
                                    return '<input id="toggle-demo" class="my_switch" type="checkbox" data-toggle="toggle" data-on="เปิดใช้งาน" data-off="ปิดใช้งาน" data-onstyle="success" data-offstyle="danger" onchange="ActivateStatus(' + data.emP_ID + ',' + data.activate + ');"   checked >';
                                }


                            }
                        },
                        {
                            'data': 'ID',
                            'orderable': false,
                            "className": "text-center",
                            sWidth: "5%",
                            'mRender': function (ID, type, data, obj) {
                                if (data.activate != "1") {
                                    return '<a class="btn btn-danger btn-xs" data-toggle="tooltip" title="จัดการข้อมูล">จัดการข้อมูล</a>';

                                }
                                else {
                                    return '<a class="btn btn-primary btn-xs" data-toggle="tooltip" onclick="OpenModalDetailAccount(' + data.emP_ID + ')" title="จัดการข้อมูล">จัดการข้อมูล</a>';
                                }
                            }
                        }

                    ],
                    "fnDrawCallback": function () {
                        $('.my_switch').bootstrapToggle();

                    }
                });

            });
        }

        function TestDataTablesRemove(table) {
            $(document).ready(function () {
                $(table).DataTable().destroy();
                var elEM = document.querySelector(table + '_wrapper');
                elEM.parentNode.removeChild(elEM);
            });
        }

        function ActivateStatus(id, activestatus) {

            if (activestatus == "1") {
                var ActiveStatus = {
                    emP_ID: id,
                    activate: "2",
                };
                $.ajax({
                    url: 'http://localhost:4000/api/UserAccount/ActiveStatus',
                    type: 'PUT',
                    contentType: "application/json",
                    data: JSON.stringify(ActiveStatus),
                    dataType: "json",
                    async: true,
                    success: function () {
                        var mytbl = $("#example").DataTable();
                        mytbl.ajax.reload(null, false);
                        console.log("success");

                    }
                });
            }
            if (activestatus == "2") {
                var ActiveStatus = {
                    emP_ID: id,
                    activate: "1",
                };
                $.ajax({
                    url: 'http://localhost:4000/api/UserAccount/ActiveStatus',
                    type: 'PUT',
                    contentType: "application/json",
                    data: JSON.stringify(ActiveStatus),
                    dataType: "json",
                    async: true,
                    success: function () {
                        var mytbl = $("#example").DataTable();
                        mytbl.ajax.reload(null, false);
                        console.log("success");
                    }
                });
            }

        }

        function OpenModalDetailAccount(id) {
            var callidem = { emP_ID: id };
            $('#ViewHistory').modal('show');

            $.ajax({
                url: 'http://localhost:4000/api/UserAccount/GetUserAccountId',
                type: 'POST',
                contentType: "application/json",
                data: JSON.stringify(callidem),
                dataType: "json",
                async: true,
                success: function (result) {
                    $("#emP_ID").html(result[0]["emP_ID"]);
                    $("#nameTH").val(result[0]["emP_NAMETH"]);
                    $("#lastTH").val(result[0]["emP_LASTNAMETH"]);
                    $("#namEn").val(result[0]["emP_NAME"]);
                    $("#lastEn").val(result[0]["emP_LASTNAME"]);
                    $("#nicknameTH").val(result[0]["emP_NICKNAMETH"]);
                    $("#nicknameEn").val(result[0]["emP_NICKNAME"]);
                    $("#telephone").val(result[0]["emP_TEL"]);
                    $("#email").val(result[0]["emP_MAIL"]);
                    $("#position").val(result[0]["emP_DEPT"]);

                },
                error: function (status) {
                    alert("error");
                }
            });
        };

        function OpenElement() {
            document.getElementById('updateimg').style.visibility = 'visible';
            $("#nameTH").prop('disabled', false);
            $("#lastTH").prop('disabled', false);
            $("#namEn").prop('disabled', false);
            $("#lastEn").prop('disabled', false);
            $("#nicknameTH").prop('disabled', false);
            $("#nicknameEn").prop('disabled', false);
            $("#telephone").prop('disabled', false);
            $("#position").prop('disabled', false);
        };

        function CloseElement() {
            document.getElementById('updateimg').style.visibility = 'hidden';
            $("#nameTH").prop('disabled', true);
            $("#lastTH").prop('disabled', true);
            $("#namEn").prop('disabled', true);
            $("#lastEn").prop('disabled', true);
            $("#nicknameTH").prop('disabled', true);
            $("#nicknameEn").prop('disabled', true);
            $("#telephone").prop('disabled', true);
            $("#position").prop('disabled', true);
        }
    </script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

</body>

</html>
